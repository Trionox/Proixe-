<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Checkout - Proixe Store</title>
<style>
body{font-family:Arial;margin:0;background:#f9f9f9;}
header{background:#2c3e50;color:white;padding:15px;text-align:center;}
nav a{color:white;margin:0 15px;text-decoration:none;font-weight:bold;}
nav a:hover{text-decoration:underline;}
.container{max-width:500px;margin:auto;background:white;padding:20px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.2);}
input,button{width:100%;padding:10px;margin:10px 0;border-radius:5px;border:1px solid #ccc;}
button{background:#3498db;color:white;border:none;cursor:pointer;}
button:hover{background:#1d6fa5;}
.cart-summary{background:#f1f1f1;padding:10px;margin-bottom:10px;border-radius:5px;}
</style>
</head>
<body>
<header>
<h1>Proixe Store</h1>
<nav>
<a href="index.html">Home</a>
<a href="plants.html">Plants</a>
<a href="grocery.html">Grocery</a>
<a href="clothes.html">Clothes</a>
<a href="cart.html">Cart</a>
<a href="account.html">Account</a>
</nav>
</header>

<div class="container">
<h2>Checkout</h2>

<div id="cart-summary"></div>

<form id="checkout-form">
  <input type="text" id="customer-name" placeholder="Name" required>
  <input type="text" id="customer-address" placeholder="Address" required>
  <input type="text" id="customer-phone" placeholder="Phone" required>
  <button type="submit">Place Order</button>
</form>
</div>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
emailjs.init("YOUR_PUBLIC_ID"); // <- yaha apna EmailJS public ID dal

let cart = JSON.parse(localStorage.getItem("cart")) || [];

function renderCartSummary(){
  const summary = document.getElementById("cart-summary");
  if(cart.length===0){
    summary.innerHTML="<p>Cart is empty!</p>";
    return;
  }
  let html = "";
  cart.forEach(item=>{
    html += `<div class="cart-summary">
               <p>${item.name} x ${item.qty} = ₹${item.price*item.qty}</p>
             </div>`;
  });
  html += <p><strong>Total: ₹${cart.reduce((a,b)=>a+b.price*b.qty,0)}</strong></p>;
  summary.innerHTML = html;
}

renderCartSummary();

document.getElementById("checkout-form").addEventListener("submit",function(e){
  e.preventDefault();
  if(cart.length===0){ alert("Cart is empty!"); return; }

  const order = {
    customer:{
      name:document.getElementById("customer-name").value,
      address:document.getElementById("customer-address").value,
      phone:document.getElementById("customer-phone").value
    },
    products: cart,
    total: cart.reduce((a,b)=>a+b.price*b.qty,0),
    date: new Date().toLocaleString()
  };

  // Save orders for account tracking
  let orders = JSON.parse(localStorage.getItem("orders")) || [];
  orders.push(order);
  localStorage.setItem("orders",JSON.stringify(orders));

  // Notify Owner via EmailJS
  emailjs.send("YOUR_SERVICE_ID","YOUR_TEMPLATE_ID",{
    customer_name: order.customer.name,
    customer_address: order.customer.address,
    customer_phone: order.customer.phone,
    order_details: JSON.stringify(order.products),
    total_price: order.total
  }).then(res=>console.log("Owner notified!",res.status))
    .catch(err=>console.log("Error sending notification",err));

  localStorage.removeItem("cart");
  alert("Order placed successfully! You can track it in your Account page.");
  window.location.href="account.html";
});
</script>
</body>
</html>
